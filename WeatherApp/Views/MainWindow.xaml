<Window x:Class="WeatherApp.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Система мониторинга погоды" Height="800" Width="1200"
        WindowStartupLocation="CenterScreen">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Заголовок -->
        <Border Grid.Row="0" Background="#2E3440" Padding="10">
            <TextBlock Text="Система мониторинга метеорологических условий" 
                       FontSize="20" FontWeight="Bold" 
                       Foreground="White" HorizontalAlignment="Center"/>
        </Border>

        <!-- Основной контент -->
        <TabControl Grid.Row="1" Margin="10">
            
            <!-- Вкладка: Данные о погоде -->
            <TabItem Header="Данные о погоде">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Список данных о погоде -->
                    <GroupBox Grid.Column="0" Header="Записи о погоде" Margin="5">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- Кнопки управления -->
                            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="5">
                                <Button Content="Обновить" Command="{Binding RefreshDataCommand}" Margin="2"/>
                                <Button Content="Добавить" Command="{Binding AddWeatherDataCommand}" Margin="2"/>
                                <Button Content="Изменить" Command="{Binding UpdateWeatherDataCommand}" Margin="2"/>
                                <Button Content="Удалить" Command="{Binding DeleteWeatherDataCommand}" Margin="2"/>
                            </StackPanel>

                            <!-- Таблица данных -->
                            <DataGrid Grid.Row="1" ItemsSource="{Binding WeatherData}" 
                                      SelectedItem="{Binding SelectedWeatherData}"
                                      AutoGenerateColumns="False" CanUserAddRows="False"
                                      GridLinesVisibility="Horizontal" HeadersVisibility="Column">
                                 <DataGrid.Columns>
                                     <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                                     <DataGridTextColumn Header="Дата" Binding="{Binding Date, StringFormat=dd.MM.yyyy HH:mm}" Width="120"/>
                                     <DataGridTextColumn Header="Местоположение" Binding="{Binding Location}" Width="150"/>
                                     <DataGridTextColumn Header="Температура (°C)" Binding="{Binding Temperature, StringFormat=F1}" Width="80"/>
                                     <DataGridTextColumn Header="Влажность (%)" Binding="{Binding Humidity, StringFormat=F1}" Width="80"/>
                                     <DataGridTextColumn Header="Давление (гПа)" Binding="{Binding Pressure, StringFormat=F1}" Width="80"/>
                                     <DataGridTextColumn Header="Ветер (м/с)" Binding="{Binding WindSpeed, StringFormat=F1}" Width="80"/>
                                     <DataGridTextColumn Header="Регион" Binding="{Binding Region}" Width="80"/>
                                     <DataGridCheckBoxColumn Header="Факт" Binding="{Binding IsActual}" Width="60"/>
                                 </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </GroupBox>

                    <!-- Форма ввода/редактирования -->
                    <GroupBox Grid.Column="1" Header="Ввод данных" Margin="5">
                        <ScrollViewer>
                            <StackPanel Margin="10">
                                <Label Content="Местоположение:"/>
                                <TextBox Text="{Binding SelectedWeatherData.Location}" Margin="0,0,0,10"/>

                                <Label Content="Дата и время:"/>
                                <DatePicker SelectedDate="{Binding SelectedWeatherData.Date}" Margin="0,0,0,10"/>

                                <Label Content="Температура (°C):"/>
                                <TextBox Text="{Binding SelectedWeatherData.Temperature}" Margin="0,0,0,10"/>

                                <Label Content="Влажность (%):"/>
                                <TextBox Text="{Binding SelectedWeatherData.Humidity}" Margin="0,0,0,10"/>

                                <Label Content="Давление (гПа):"/>
                                <TextBox Text="{Binding SelectedWeatherData.Pressure}" Margin="0,0,0,10"/>

                                <Label Content="Скорость ветра (м/с):"/>
                                <TextBox Text="{Binding SelectedWeatherData.WindSpeed}" Margin="0,0,0,10"/>

                                 <Label Content="Направление ветра:"/>
                                 <ComboBox ItemsSource="{Binding WindDirections}" 
                                           SelectedItem="{Binding SelectedWeatherData.WindDirection}" 
                                           Margin="0,0,0,10"/>

                                 <Label Content="Осадки (мм):"/>
                                 <TextBox Text="{Binding SelectedWeatherData.Precipitation}" Margin="0,0,0,10"/>

                                 <Label Content="Погодные условия:"/>
                                 <ComboBox ItemsSource="{Binding WeatherConditions}" 
                                           SelectedItem="{Binding SelectedWeatherData.WeatherCondition}" 
                                           Margin="0,0,0,10"/>

                                <Label Content="Видимость (км):"/>
                                <ComboBox ItemsSource="{Binding VisibilityOptions}" 
                                          SelectedItem="{Binding SelectedWeatherData.Visibility}" 
                                          Margin="0,0,0,10"/>

                                <Label Content="Облачность (%):"/>
                                <ComboBox ItemsSource="{Binding CloudCoverOptions}" 
                                          SelectedItem="{Binding SelectedWeatherData.CloudCover}" 
                                          Margin="0,0,0,10"/>

                                 <Label Content="Регион:"/>
                                 <ComboBox ItemsSource="{Binding Regions}" SelectedItem="{Binding SelectedRegion}" Margin="0,0,0,10">
                                     <ComboBox.ItemTemplate>
                                         <DataTemplate>
                                             <StackPanel>
                                                 <TextBlock Text="{Binding}" FontWeight="Bold"/>
                                                 <TextBlock Text="{Binding DataContext.RegionInfos, RelativeSource={RelativeSource AncestorType=Window}}" 
                                                            FontSize="10" Foreground="Gray"/>
                                             </StackPanel>
                                         </DataTemplate>
                                     </ComboBox.ItemTemplate>
                                 </ComboBox>

                                <CheckBox Content="Фактические данные" IsChecked="{Binding SelectedWeatherData.IsActual}" Margin="0,0,0,10"/>
                            </StackPanel>
                        </ScrollViewer>
                    </GroupBox>
                </Grid>
            </TabItem>

            <!-- Вкладка: Прогнозы -->
            <TabItem Header="Прогнозы">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                     <!-- Кнопки управления прогнозами -->
                     <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="10">
                         <Button Content="Сгенерировать прогноз" Command="{Binding GenerateForecastCommand}" Margin="2"/>
                         <Button Content="Оценить точность" Command="{Binding EvaluateForecastCommand}" Margin="2"/>
                         <Button Content="Очистить прогнозы" Command="{Binding ClearForecastsCommand}" Margin="2"/>
                         <ComboBox ItemsSource="{Binding Regions}" SelectedItem="{Binding SelectedRegion}" Width="120" Margin="10,0"/>
                     </StackPanel>

                    <!-- Таблица прогнозов -->
                    <DataGrid Grid.Row="1" ItemsSource="{Binding Forecasts}" 
                              SelectedItem="{Binding SelectedForecast}"
                              AutoGenerateColumns="False" CanUserAddRows="False"
                              GridLinesVisibility="Horizontal" HeadersVisibility="Column" Margin="10">
                         <DataGrid.Columns>
                             <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                             <DataGridTextColumn Header="Дата прогноза" Binding="{Binding ForecastDate, StringFormat=dd.MM.yyyy}" Width="100"/>
                             <DataGridTextColumn Header="Местоположение" Binding="{Binding Location}" Width="120"/>
                             <DataGridTextColumn Header="Температура (°C)" Binding="{Binding PredictedTemperature, StringFormat=F1}" Width="80"/>
                             <DataGridTextColumn Header="Влажность (%)" Binding="{Binding PredictedHumidity, StringFormat=F1}" Width="80"/>
                             <DataGridTextColumn Header="Давление (гПа)" Binding="{Binding PredictedPressure, StringFormat=F1}" Width="80"/>
                             <DataGridTextColumn Header="Ветер (м/с)" Binding="{Binding PredictedWindSpeed, StringFormat=F1}" Width="80"/>
                             <DataGridTextColumn Header="Уверенность (%)" Binding="{Binding Confidence, StringFormat=F1}" Width="80"/>
                             <DataGridTextColumn Header="Регион" Binding="{Binding Region}" Width="80"/>
                         </DataGrid.Columns>
                    </DataGrid>
                </Grid>
            </TabItem>

             <!-- Вкладка: Анализ регионов -->
             <TabItem Header="Анализ регионов">
                 <Grid>
                     <Grid.RowDefinitions>
                         <RowDefinition Height="Auto"/>
                         <RowDefinition Height="*"/>
                     </Grid.RowDefinitions>

                     <!-- Кнопки анализа -->
                     <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="10">
                         <Button Content="Анализировать все регионы" Command="{Binding AnalyzeRegionCommand}" Margin="2"/>
                     </StackPanel>

                     <!-- Результаты анализа -->
                     <DataGrid Grid.Row="1" ItemsSource="{Binding RegionalAnalyses}" 
                               SelectedItem="{Binding SelectedAnalysis}"
                               AutoGenerateColumns="False" CanUserAddRows="False"
                               GridLinesVisibility="Horizontal" HeadersVisibility="Column" Margin="10">
                         <DataGrid.Columns>
                             <DataGridTextColumn Header="Регион" Binding="{Binding Region}" Width="100"/>
                             <DataGridTextColumn Header="Дата анализа" Binding="{Binding AnalysisDate, StringFormat=dd.MM.yyyy HH:mm}" Width="120"/>
                             <DataGridTextColumn Header="Ср. температура (°C)" Binding="{Binding AverageTemperature, StringFormat=F1}" Width="100"/>
                             <DataGridTextColumn Header="Ср. влажность (%)" Binding="{Binding AverageHumidity, StringFormat=F1}" Width="100"/>
                             <DataGridTextColumn Header="Ср. давление (гПа)" Binding="{Binding AveragePressure, StringFormat=F1}" Width="100"/>
                             <DataGridTextColumn Header="Ср. ветер (м/с)" Binding="{Binding AverageWindSpeed, StringFormat=F1}" Width="100"/>
                             <DataGridTextColumn Header="Паттерн" Binding="{Binding WeatherPattern}" Width="150"/>
                             <DataGridTextColumn Header="Надежность" Binding="{Binding ForecastReliability}" Width="100"/>
                         </DataGrid.Columns>
                     </DataGrid>
                 </Grid>
             </TabItem>

             <!-- Вкладка: Описание регионов -->
             <TabItem Header="Описание регионов">
                 <ScrollViewer>
                     <StackPanel Margin="20">
                         <TextBlock Text="Характеристики регионов" FontSize="24" FontWeight="Bold" Margin="0,0,0,20"/>
                         
                         <ItemsControl ItemsSource="{Binding RegionInfos}">
                             <ItemsControl.ItemTemplate>
                                 <DataTemplate>
                                     <Border BorderBrush="#2E3440" BorderThickness="2" CornerRadius="10" Margin="0,0,0,20" Padding="20">
                                         <StackPanel>
                                             <TextBlock Text="{Binding Name}" FontSize="20" FontWeight="Bold" Foreground="#2E3440" Margin="0,0,0,10"/>
                                             <TextBlock Text="{Binding Description}" FontSize="14" Margin="0,0,0,15"/>
                                             
                                             <TextBlock Text="Характеристики:" FontSize="16" FontWeight="Bold" Margin="0,0,0,5"/>
                                             <TextBlock Text="{Binding Characteristics}" FontSize="12" TextWrapping="Wrap" Margin="0,0,0,10"/>
                                             
                                             <TextBlock Text="Типичная погода:" FontSize="16" FontWeight="Bold" Margin="0,0,0,5"/>
                                             <TextBlock Text="{Binding TypicalWeather}" FontSize="12" TextWrapping="Wrap" Margin="0,0,0,10"/>
                                             
                                             <TextBlock Text="Рекомендации:" FontSize="16" FontWeight="Bold" Margin="0,0,0,5"/>
                                             <TextBlock Text="{Binding Recommendations}" FontSize="12" TextWrapping="Wrap"/>
                                         </StackPanel>
                                     </Border>
                                 </DataTemplate>
                             </ItemsControl.ItemTemplate>
                         </ItemsControl>
                     </StackPanel>
                 </ScrollViewer>
             </TabItem>

        </TabControl>

        <!-- Статусная строка -->
        <Border Grid.Row="2" Background="#3B4252" Padding="10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock Grid.Column="0" Text="{Binding StatusMessage}" 
                           Foreground="White" VerticalAlignment="Center"/>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <TextBlock Text="Загрузка..." Foreground="Orange" 
                               Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
